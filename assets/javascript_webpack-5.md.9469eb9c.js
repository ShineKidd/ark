import{o as n,c as s,d as a}from"./app.2a3e59c4.js";const p='{"title":"webpack","description":"","frontmatter":{"title":"webpack"},"headers":[{"level":3,"title":"Getting Started","slug":"getting-started"},{"level":2,"title":"Config","slug":"config"},{"level":3,"title":"mode","slug":"mode"},{"level":3,"title":"entry","slug":"entry"},{"level":3,"title":"output","slug":"output"},{"level":3,"title":"loader","slug":"loader"},{"level":3,"title":"plugins","slug":"plugins"},{"level":3,"title":"optimization","slug":"optimization"},{"level":3,"title":"devServer","slug":"devserver"},{"level":3,"title":"peformance","slug":"peformance"},{"level":3,"title":"devtool","slug":"devtool"},{"level":3,"title":"externals","slug":"externals"},{"level":3,"title":"resolve","slug":"resolve"},{"level":3,"title":"resolveLoadrs","slug":"resolveloadrs"},{"level":2,"title":"node","slug":"node"},{"level":2,"title":"Official Loader","slug":"official-loader"},{"level":3,"title":"style-loader","slug":"style-loader"},{"level":3,"title":"css-loader","slug":"css-loader"},{"level":3,"title":"postcss-loader","slug":"postcss-loader"},{"level":3,"title":"less-loader","slug":"less-loader"},{"level":3,"title":"url-loader","slug":"url-loader"},{"level":3,"title":"file-loader","slug":"file-loader"},{"level":3,"title":"eslint-loader","slug":"eslint-loader"},{"level":3,"title":"babel-loader","slug":"babel-loader"},{"level":3,"title":"thread-loader","slug":"thread-loader"},{"level":3,"title":"cache-loader","slug":"cache-loader"},{"level":2,"title":"Official Plugin","slug":"official-plugin"},{"level":3,"title":"html-webpack-plugin","slug":"html-webpack-plugin"},{"level":3,"title":"inline-chunk-html-plugin","slug":"inline-chunk-html-plugin"},{"level":3,"title":"mini-css-extract-plugin","slug":"mini-css-extract-plugin"},{"level":3,"title":"@intervolga/optimize-cssnano-plugin","slug":"intervolga-optimize-cssnano-plugin"},{"level":3,"title":"optimize-css-assets-webpack-plugin","slug":"optimize-css-assets-webpack-plugin"},{"level":3,"title":"workbox-webpack-plugin","slug":"workbox-webpack-plugin"},{"level":3,"title":"webpack.DllPlugin","slug":"webpack-dllplugin"},{"level":3,"title":"webpack.DefinePlugin","slug":"webpack-defineplugin"},{"level":3,"title":"webpack.HotModuleReplacementPlugin","slug":"webpack-hotmodulereplacementplugin"},{"level":3,"title":"webpack.IgnorePlugin","slug":"webpack-ignoreplugin"},{"level":3,"title":"manifest-plugin","slug":"manifest-plugin"},{"level":2,"title":"Hash","slug":"hash"},{"level":2,"title":"Tree Shaking","slug":"tree-shaking"},{"level":2,"title":"Code Split","slug":"code-split"},{"level":2,"title":"Optimize","slug":"optimize"},{"level":3,"title":"development","slug":"development"},{"level":3,"title":"production","slug":"production"}],"relativePath":"javascript/webpack-5.md","lastUpdated":1620573299631}',t={},e=a('<p>åŸºäº webpack4.x æ•´ç†</p><h3 id="getting-started"><a class="header-anchor" href="#getting-started" aria-hidden="true">#</a> Getting Started</h3><p>æ— éœ€é…ç½®ï¼Œ<code>webpack</code> èƒ½ç›´æ¥å¤„ç† js/jsonï¼Œæ”¯æŒ ES module</p><div class="language-bash"><pre><code>webpack src/entry.js -o dits/bundle.js --mode<span class="token operator">=</span>development\n</code></pre></div><p><code>webpack</code> é»˜è®¤è¯»å–å·¥ä½œç›®å½•ä¸‹çš„ <code>webpack.config.js</code> æ–‡ä»¶</p><h2 id="config"><a class="header-anchor" href="#config" aria-hidden="true">#</a> Config</h2><h3 id="mode"><a class="header-anchor" href="#mode" aria-hidden="true">#</a> mode</h3><p>production æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨å‹ç¼© js ä»£ç </p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">// mode: &#39;production&#39;,</span>\n  mode<span class="token operator">:</span> <span class="token string">&#39;develoment&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="entry"><a class="header-anchor" href="#entry" aria-hidden="true">#</a> entry</h3><p>å•æ–‡ä»¶å…¥å£ï¼Œæ‰“åŒ…ååªç”Ÿæˆä¸€ä¸ª chunk <code>main.js</code></p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  entry<span class="token operator">:</span> <span class="token string">&#39;src/index.js&#39;</span><span class="token punctuation">,</span>\n  <span class="token comment">// entry: [&#39;src/index.js&#39;, &#39;public/index.html&#39;],</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>å¤šæ–‡ä»¶å…¥å£ï¼Œæ‰“åŒ…åç”Ÿæˆå¤šä¸ª chunk <code>page1.js</code> <code>page2.js</code> å¯ç”¨äºå¤šé¡µé¢æ‰“åŒ…</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  entry<span class="token operator">:</span> <span class="token punctuation">{</span>\n    page1<span class="token operator">:</span> <span class="token string">&#39;src/page1/index.js&#39;</span><span class="token punctuation">,</span>\n    page2<span class="token operator">:</span> <span class="token string">&#39;src/page2/index.js&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="output"><a class="header-anchor" href="#output" aria-hidden="true">#</a> output</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  output<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* æŒ‡å®šç›®å½• + åç§° */</span>\n    filename<span class="token operator">:</span> <span class="token string">&#39;js/[name].[contenthash:10].js&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* æŒ‡å®šæ‰“åŒ…ç»“æœç»Ÿä¸€è¾“å‡ºç›®å½• */</span>\n    path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* æ‰€æœ‰èµ„æºå¼•å…¥è·¯å¾„çš„å‰ç¼€ */</span>\n    publicPath<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span>ï¼Œ\n\n    <span class="token comment">/**\n     * æŒ‡å®šéå…¥å£ chunk çš„å‘½åè§„åˆ™\n     * å¦‚ import() å¼•å…¥çš„èµ„æºï¼Œåå­—é»˜è®¤æ˜¯ [æ•°å­—].js\n     */</span>\n    chunkFilename<span class="token operator">:</span> <span class="token string">&#39;[name]_[chunkhash].chun.js&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* å‘å¤–æš´éœ²çš„å˜é‡å */</span>\n    library<span class="token operator">:</span> <span class="token string">&#39;myTool&#39;</span><span class="token punctuation">,</span>\n    <span class="token comment">/* è¾“å‡ºå“ªç§æ¨¡å—è§„èŒƒ */</span>\n    libraryTarget<span class="token operator">:</span> <span class="token string">&#39;commonjs&#39;</span><span class="token punctuation">,</span> <span class="token comment">// amd | umd | global | window</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="loader"><a class="header-anchor" href="#loader" aria-hidden="true">#</a> loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  module<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* ä¸å‚ä¸è§£æçš„åº“ */</span>\n    noParse<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(vue|vue-router|vuex|vuex-router-sync)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n    rules<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// é…ç½®å½¢å¼ä¸€</span>\n      <span class="token punctuation">{</span>\n        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n        use<span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token string">&#39;less-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span>\n            loader<span class="token operator">:</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">,</span>\n            options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span><span class="token punctuation">,</span>\n        sideEffects<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token comment">// é…ç½®å½¢å¼äºŒ</span>\n      <span class="token punctuation">{</span>\n        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(jpe?g|png|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n        loader<span class="token operator">:</span> <span class="token string">&#39;url-loader&#39;</span><span class="token punctuation">,</span>\n        options<span class="token operator">:</span> <span class="token punctuation">{</span>\n          limit<span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>\n          outputPath<span class="token operator">:</span> <span class="token string">&#39;imgs&#39;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p>å†™åœ¨åé¢çš„ loader å…ˆæ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œç»“æœäº¤ç”±å‰ä¸€ä¸ª loader å¤„ç†</p></div><h3 id="plugins"><a class="header-anchor" href="#plugins" aria-hidden="true">#</a> plugins</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="optimization"><a class="header-anchor" href="#optimization" aria-hidden="true">#</a> optimization</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* ç”Ÿäº§ç¯å¢ƒå¼€å¯å‹ç¼© */</span>\n    minimize<span class="token operator">:</span> isEnvProduction<span class="token punctuation">,</span>\n    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">/**\n       * å°† node_modules çš„ä»£ç æ‰“åŒ…æˆä¸€ä¸ªå•ç‹¬çš„ chunk\n       * ä¼šè‡ªåŠ¨åˆ†æå¤šå…¥å£ï¼Œå¹¶æŠ½ç¦»å…¬å…±çš„ä¾èµ–\n       */</span>\n      chunks<span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span>\n      <span class="token comment">/* å½“ chunk å¤§äº 30k æ‰ä¼šè¢«åˆ†å‰²å‡ºæ¥ */</span>\n      minSize<span class="token operator">:</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>\n      maxSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\n      <span class="token comment">/* ä¾èµ–è‡³å°‘è¢«å¼•ç”¨ 1æ¬¡ */</span>\n      minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n      <span class="token comment">/* æŒ‰éœ€åŠ è½½æ—¶ï¼Œå¹¶è¡ŒåŠ è½½æ–‡ä»¶çš„æœ€å¤§æ•°é‡ */</span>\n      maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>\n      <span class="token comment">/* å…¥å£ js æ–‡ä»¶æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•° */</span>\n      maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>\n      <span class="token comment">/* å‘½åè¿æ¥ç¬¦å· */</span>\n      automaticNameDelimiter<span class="token operator">:</span> <span class="token string">&#39;~&#39;</span><span class="token punctuation">,</span>\n      <span class="token comment">/* å¯ä»¥ä½¿ç”¨å‘½åè§„åˆ™ */</span>\n      name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      <span class="token comment">/* åˆ†å‰² chunk çš„ç»„ï¼Œä»¥ä¸Šè§„åˆ™å¯¹åˆ†ç»„æœ‰æ•ˆ */</span>\n      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token comment">/* node_modules ç›®å½•ä¸‹çš„åŒ…æŠ½ç¦»åˆ° vendors.js */</span>\n        vendors<span class="token operator">:</span> <span class="token punctuation">{</span>\n          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        common<span class="token operator">:</span> <span class="token punctuation">{</span>\n          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>\n          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>\n          <span class="token comment">/* å¤ç”¨å·²æå–è¿‡çš„æ¨¡å—ï¼Œä»¥å…é‡å¤æ‰“åŒ… */</span>\n          reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token comment">/**\n     * å½“ chunkA ä¾èµ– chunkB æ—¶ï¼Œ\n     * å½“ chunkA å†…è®°å½•äº† chunkB çš„ hash\n     * chunkB hash å˜åŒ–å¯¼è‡´ chunkA å†…å®¹å˜åŒ–...è¿é”ååº”\n     * å°†æ¨¡å—è®°å½•çš„ hash å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå˜åŒ–ç¼©å°åœ¨è¿™ä¸ªæ–‡ä»¶å†…\n     */</span>\n    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token parameter">entryPoint</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">runtime~</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entryPoint<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token comment">/**\n     * é…ç½®ç”Ÿäº§ç¯å¢ƒ js css å‹ç¼©æ–¹æ¡ˆ\n     * webpack 4.26.x å†…éƒ¨ä½¿ç”¨ terser-webpack-plugin åšä»£ç å‹ç¼©\n     */</span>\n    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">/* å‹ç¼© js */</span>\n      <span class="token keyword">new</span> <span class="token class-name">TerserWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// å¤šè¿›ç¨‹</span>\n        sourceMap<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token comment">/* å‹ç¼© css */</span>\n      <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        cssProcessorOptions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        cssProcessorPluginOptions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="devserver"><a class="header-anchor" href="#devserver" aria-hidden="true">#</a> devServer</h3><p>æ‰§è¡Œ <code>npx webpack-dev-server</code>ï¼Œç¼–è¯‘æ‰“åŒ…ç»“æœä¿å­˜åœ¨å†…å­˜ï¼Œä¸è¾“å‡ºæ–‡ä»¶ï¼Œwatch æ–‡ä»¶å˜åŒ–åè‡ªåŠ¨ç¼–è¯‘</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">/* æ‰“åŒ…è¾“å‡ºç›®å½• ???? */</span>\n  conentBase<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n  <span class="token comment">// watchContentBase: true,</span>\n  watchOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n    ignored<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">/* å¯ç”¨ gizp */</span>\n  compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>\n  <span class="token comment">/* åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ */</span>\n  open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token comment">/* HMR */</span>\n  hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  host<span class="token operator">:</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span>\n  proxy<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è½¬å‘ /api/xxx å¼€å¤´çš„è¯·æ±‚åˆ°æŒ‡å®šæœåŠ¡å™¨ */</span>\n    <span class="token string">&#39;/api&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      target<span class="token operator">:</span> <span class="token string">&#39;http://api.host.com:3000&#39;</span><span class="token punctuation">,</span>\n      <span class="token comment">/* è½¬å‘è¯·æ±‚å‰ï¼Œé‡å†™æ¥å£åœ°å€(å»æ‰ /api å‰ç¼€) */</span>\n      pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string">&#39;^/api&#39;</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">/* ä¸è¦æ˜¾ç¤ºå¯åŠ¨æœåŠ¡å™¨æ—¥å¿—ä¿¡æ¯ */</span>\n  clientLogLevel<span class="token operator">:</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">,</span>\n  <span class="token comment">/* åªæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ */</span>\n  quiet<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token comment">/* å‡ºé”™äº†ä¸è¦å…¨å±æç¤º */</span>\n  overlay<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p><code>style-loader</code> <code>vue-loader</code> å†…éƒ¨å®ç°äº† <code>HMR</code>ï¼Œä½† js é»˜è®¤æ²¡æœ‰å®ç°ï¼Œä¿®æ”¹ js æ–‡ä»¶ä¼šå¯¼è‡´æ‰€ä»¥æ¨¡å—é‡æ–°ç¼–è¯‘</p><p>ç¤ºä¾‹ï¼šå½“ <code>math.js</code> å†…å®¹å˜åŒ–æ—¶ï¼Œå®ç° <code>math.js</code> çƒ­æ›´æ–°</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math&#39;</span>\n\n<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n\n<span class="token comment">// åˆ¤æ–­æ˜¯å¦å¼€å¯äº† HMR</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#39;./math.js&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><h3 id="peformance"><a class="header-anchor" href="#peformance" aria-hidden="true">#</a> peformance</h3><p>å…³é—­ webpack è‡ªå¸¦çš„æ€§èƒ½åˆ†æï¼ˆæé«˜é€Ÿåº¦ï¼‰ï¼Œä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨å…¶ä»–æ’ä»¶åšæ€§èƒ½åˆ†æ</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  performance<span class="token operator">:</span> <span class="token boolean">false</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="devtool"><a class="header-anchor" href="#devtool" aria-hidden="true">#</a> devtool</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  devtool<span class="token operator">:</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><table><thead><tr><th>å–å€¼</th><th>æ•ˆæœ</th><th>source map æ–‡ä»¶</th></tr></thead><tbody><tr><td>source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œèƒ½è·³è½¬åˆ°æºä»£ç å‡ºé”™ä½ç½®</td><td>å®Œæ•´åˆ° sourceMap æ–‡ä»¶</td></tr><tr><td>inline-source-map</td><td>åŒä¸Š</td><td>æŠŠæ‰€æœ‰ sourceMap å†…è”åˆ° js å°¾éƒ¨ï¼Œä¼˜åŠ¿ï¼šæ„å»ºé€Ÿåº¦å¿«</td></tr><tr><td>eval-source-map</td><td>æ–‡ä»¶åé”™è¯¯ï¼Œå…¶ä»–åŒä¸Š</td><td>æ¯ä¸ª sourceMap åˆ†åˆ«å†…è”åˆ°æ¯ä¸ª eval å‡½æ•°ä¸­</td></tr><tr><td>hidden-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åï¼Œä½†è¡Œæ•°é”™è¯¯ï¼Œä¼šè·³è½¬åˆ°æ„å»ºåç å‡ºé”™ä½ç½®</td><td></td></tr><tr><td>nosources-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œæ— æ³•è·³è½¬åˆ°ä»£ç å‡ºé”™ä½ç½®</td><td>æ—  sourceMap æ–‡ä»¶</td></tr><tr><td>cheap-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œèƒ½è·³è½¬åˆ°æºä»£ç ä½ç½®ï¼Œä¸èƒ½ç²¾ç¡®å®šä½åˆ°é”™è¯¯æ‰€åœ¨åˆ—</td><td></td></tr><tr><td>cheap-module-source-map</td><td>åŒä¸Š</td><td>ä¼šå°† loader çš„ source map åŠ è¿›æ¥</td></tr></tbody></table><p>é€Ÿåº¦ eval &gt; inline &gt; cheap</p><p>é€Ÿåº¦ <code>eval-cheap-source-map</code> &gt; <code>eval-source-map</code></p><p>è°ƒè¯•å‹å¥½ <code>source-map</code> &gt; <code>cheap-module-source-map</code> &gt; <code>cheap-source-map</code></p><h3 id="externals"><a class="header-anchor" href="#externals" aria-hidden="true">#</a> externals</h3><p>æŒ‡å®šå¤–éƒ¨åº“ï¼Œä¸è¿›è¡Œæ‰“åŒ…å¤„ç†</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  externals<span class="token operator">:</span> <span class="token punctuation">{</span>\n    jquery<span class="token operator">:</span> <span class="token string">&#39;jQuery&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="resolve"><a class="header-anchor" href="#resolve" aria-hidden="true">#</a> resolve</h3><p>é…ç½®æ¨¡å—çš„è§£æè§„åˆ™</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è·¯å¾„åˆ«å */</span>\n    alias<span class="token operator">:</span> <span class="token punctuation">{</span>\n      @<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* è·¯å¾„åå¯çœç•¥çš„æ–‡ä»¶ç±»å‹åç¼€, æ³¨ï¼šåŒåæ–‡ä»¶ä¼šéšæ‚£ */</span>\n    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.json&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.vue&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jsx&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* é™¤äº† node_modules å¤–çš„å…¶ä»–ç›®å½•ä¸­å¯»æ‰¾ä¾èµ–æ¨¡å— */</span>\n    modules<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;node_modules&#39;</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../my-modules&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="resolveloadrs"><a class="header-anchor" href="#resolveloadrs" aria-hidden="true">#</a> resolveLoadrs</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  resolveLoadrs<span class="token operator">:</span> <span class="token punctuation">{</span>\n    modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;node_modules&#39;</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;my-loaders&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="node"><a class="header-anchor" href="#node" aria-hidden="true">#</a> node</h2><p>webpack4 ä¼šæŠŠä¸€äº› node æ¨¡å—æ‰“åŒ…è¿›æ¥ï¼Œä½†æ˜¯åœ¨æµè§ˆå™¨ç«¯ç”¨ä¸ä¸Š</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  node<span class="token operator">:</span> <span class="token punctuation">{</span>\n    module<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    dgram<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    dns<span class="token operator">:</span> <span class="token string">&#39;mock&#39;</span><span class="token punctuation">,</span>\n    fs<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    http2<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    net<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    tls<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n    child_process<span class="token operator">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="official-loader"><a class="header-anchor" href="#official-loader" aria-hidden="true">#</a> Official Loader</h2><p>loader æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°</p><p>åŒæ­¥ loader ç¤ºä¾‹</p><div class="language-js"><pre><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// process content...</span>\n\n  <span class="token comment">// ç›´æ¥è¿”å›å¤„ç†ç»“æœæˆ–ä½¿ç”¨å›è°ƒ</span>\n  <span class="token keyword">return</span> content <span class="token comment">// or this.call(err, content, map?, meta?)</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// å„ä¸ª loader çš„ pitch å‡½æ•°æ˜¯æŒ‰é…ç½® loader çš„é¡ºåºæ‰§è¡Œ</span>\n<span class="token comment">// è¿™å’Œ use ä¸­ loader çš„æ‰§è¡Œé¡ºåºç›¸å</span>\nmodule<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">pitch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span>\n</code></pre></div><p>å¼‚æ­¥ loader ç¤ºä¾‹ï¼ˆæ¨èï¼‰</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> getOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;loader-utils&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> validate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;schema-utils&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>\n  type<span class="token operator">:</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å‚æ•°ç±»å‹</span>\n  properties<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// é…ç½®é¡¹åŠå…¶å€¼çš„ç±»å‹</span>\n    maxSize<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&#39;æœ€å¤§xxxå€¼&#39;</span> <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  additionalProperties<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸å­˜åœ¨é¢å¤–çš„å±æ€§</span>\n<span class="token punctuation">}</span>\n\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// è·å– loder çš„ options é…ç½®</span>\n  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n  <span class="token comment">// æ ¡éªŒ options é…ç½®æ˜¯å¦æ­£ç¡®</span>\n  <span class="token function">validate</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;my loader&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> content<span class="token punctuation">,</span> map<span class="token operator">?</span><span class="token punctuation">,</span> meta<span class="token operator">?</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="style-loader"><a class="header-anchor" href="#style-loader" aria-hidden="true">#</a> style-loader</h3><h3 id="css-loader"><a class="header-anchor" href="#css-loader" aria-hidden="true">#</a> css-loader</h3><h3 id="postcss-loader"><a class="header-anchor" href="#postcss-loader" aria-hidden="true">#</a> postcss-loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    loader<span class="token operator">:</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">,</span>\n    options<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">/* å›ºå®šå†™æ³• */</span>\n      ident<span class="token operator">:</span> <span class="token string">&#39;postcss&#39;</span><span class="token punctuation">,</span>\n      <span class="token function">plugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">[</span>\n          <span class="token comment">/**\n           * è¯¥æ’ä»¶ç”¨äºè§£æ(package.json) browserslist çš„é…ç½®\n           * ä»¥æ„å»ºå…¼å®¹åˆ°æŒ‡å®šæµè§ˆå™¨çš„ css\n           */</span>\n          <span class="token function">required</span><span class="token punctuation">(</span><span class="token string">&#39;postcss-preset-env&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p><code>package.json</code> ä¸­çš„é…ç½®</p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;browserslist&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;development&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&quot;last 1 chrome version&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;last 1 firefox version&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;last 1 safari version&quot;</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;production&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&quot;&gt;2%&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;not dead&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;not op_mini all&quot;</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p><code>postcss-preset-env</code> ä¾èµ– <code>process.<wbr>env.NODE_ENV</code> è¯»å– <code>browserslist</code> å¯¹åº”çš„é…ç½®ï¼Œåº”ç¡®ä¿è¯¥å€¼æ­£ç¡®è®¾ç½®</p></div><h3 id="less-loader"><a class="header-anchor" href="#less-loader" aria-hidden="true">#</a> less-loader</h3><h3 id="url-loader"><a class="header-anchor" href="#url-loader" aria-hidden="true">#</a> url-loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(bmp|jpe?g|png|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;url-loader&#39;</span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è½¬ base64 çš„ä¸Šé™ */</span>\n    limit<span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* ä½¿ç”¨ es module è§£æ */</span>\n    esModule<span class="token operator">:</span> <span class="token boolean">true</span>ï¼Œ\n\n    name<span class="token operator">:</span> <span class="token string">&#39;[contenthash:10].[ext]&#39;</span><span class="token punctuation">,</span>\n\n    fallback<span class="token operator">:</span> <span class="token punctuation">{</span>\n      loader<span class="token operator">:</span> <span class="token string">&#39;option-loader&#39;</span><span class="token punctuation">,</span>\n      options<span class="token operator">:</span> <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">&#39;media/[name][hash:8].[ext]&#39;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="file-loader"><a class="header-anchor" href="#file-loader" aria-hidden="true">#</a> file-loader</h3><p>å’Œ <code>url-loader</code> ç±»ä¼¼ï¼Œä½†æ˜¯ä¸ä¼šè½¬ <code>base64</code></p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">// test: /\\.(woff)$/, å¯ä»¥ä¸æŒ‡å®š</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(css|less|scss|js|json|jpe?g|png|gif|)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;file-loader&#39;</span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;[contenthash:10].[ext]&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="eslint-loader"><a class="header-anchor" href="#eslint-loader" aria-hidden="true">#</a> eslint-loader</h3><p>å®‰è£… <code>eslint</code> <code>eslint-plugin-import</code></p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;eslint-loader&#39;</span><span class="token punctuation">,</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// æé«˜æ€§èƒ½</span>\n  enforce<span class="token operator">:</span> <span class="token string">&#39;pre&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å¿…é¡»ä¼˜å…ˆæ‰§è¡Œï¼Œæ£€æŸ¥ä¸é€šè¿‡å°±ä¸èµ°åé¢çš„ loader</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è‡ªåŠ¨ä¿®å¤é”™è¯¯ */</span>\n    fix<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>å®‰è£… <code>eslint-config-airbnb-base</code> å¹¶åœ¨ <code>package.json</code> ä¸­é…ç½®</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token string">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb-base&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token string">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="tip custom-block"><p class="custom-block-title">ğŸ’¡</p><p>è®¾ç½® <code>env.browser</code>ï¼Œå¦åˆ™ eslint ä¼šåˆ¤å®š <code>window</code> <code>document</code> <code>navigator</code> æ˜¯æœªå£°æ˜å˜é‡</p></div><p>å¸¸ç”¨çš„è¡Œå†…è§„åˆ™</p><div class="language-js"><pre><code><span class="token comment">// eslint-disable-next-line</span>\n\n<span class="token comment">/* global jQuery */</span>\n</code></pre></div><h3 id="babel-loader"><a class="header-anchor" href="#babel-loader" aria-hidden="true">#</a> babel-loader</h3><p>å®‰è£… <code>@babel/core</code> (æ ¸å¿ƒ) <code>@babel/preset-env</code>ï¼ˆè§„åˆ™é›†ï¼‰ <code>core-js</code>ï¼ˆå…¼å®¹ APIï¼‰</p><blockquote><p>As of Babel 7.4.0, <code>@babel/polyfill</code> has been deprecated in favor of directly including <code>core-js/stable</code> (to polyfill ECMAScript features) and `...</p></blockquote><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* é¢„è®¾è§„åˆ™ */</span>\n    presets<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        <span class="token comment">/* åªå¼•å…¥ä½¿ç”¨åˆ°çš„ polyfill */</span>\n        useBuiltIns<span class="token operator">:</span> <span class="token string">&#39;useage&#39;</span><span class="token punctuation">,</span>\n\n        <span class="token comment">/* æŒ‡å®šå½“å‰å®‰è£…çš„ç‰ˆæœ¬ */</span>\n        corejs<span class="token operator">:</span> <span class="token punctuation">{</span> version<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n        targets<span class="token operator">:</span> <span class="token punctuation">{</span>\n          chrome<span class="token operator">:</span> <span class="token string">&#39;60&#39;</span><span class="token punctuation">,</span>\n          firefox<span class="token operator">:</span> <span class="token string">&#39;60&#39;</span><span class="token punctuation">,</span>\n          safari<span class="token operator">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span>\n          ie<span class="token operator">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span>\n          edge<span class="token operator">:</span> <span class="token string">&#39;17&#39;</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">]</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token comment">/* äºŒæ¬¡æ„å»ºæ—¶ï¼Œè¯»å–ä¹‹å‰ çš„ç¼“å­˜ */</span>\n    cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p><code>babel-loader</code> æœ¬èº«æ”¯æŒç¼“å­˜ï¼Œå¯ä»¥ä¸ä½¿ç”¨ <code>cache-loader</code></p><h3 id="thread-loader"><a class="header-anchor" href="#thread-loader" aria-hidden="true">#</a> thread-loader</h3><p>é…åˆ <code>babel-loader</code> å¼€å¯å¤šè¿›ç¨‹ç¼–è¯‘</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  use<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n      loader<span class="token operator">:</span> <span class="token string">&#39;thread-loader&#39;</span><span class="token punctuation">,</span>\n      options<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token comment">/* è¿›ç¨‹ä¸ªæ•° */</span>\n        workers<span class="token operator">:</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span> exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p>è¿›ç¨‹å¯åŠ¨å¤§æ¦‚ 600ms ï¼Œè¿›ç¨‹ä¹‹é—´é€šä¿¡ä¹Ÿè¦æ¶ˆè€—æ—¶é—´ï¼Œå¦‚æœé¡¹ç›®éå¸¸å°ï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨</p></div><h3 id="cache-loader"><a class="header-anchor" href="#cache-loader" aria-hidden="true">#</a> cache-loader</h3><h2 id="official-plugin"><a class="header-anchor" href="#official-plugin" aria-hidden="true">#</a> Official Plugin</h2><p>webpack å®šä¹‰äº†å¾ˆå¤šç¼–è¯‘è¿‡ç¨‹ä¸­çš„é’©å­ï¼Œè¿™äº›é’©å­ Tapable ç±»çš„å®ç°</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> RawSource <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-sources&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> validate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;schema-utils&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> globby <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;globby&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>\n  type<span class="token operator">:</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">,</span>\n  properties<span class="token operator">:</span> <span class="token punctuation">{</span>\n    to<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&#39;èµ·å§‹ç›®å½•&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">,</span>\n    <span class="token keyword">from</span><span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&#39;ç›®æ ‡ç›®å½•&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">,</span>\n    ignore<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;array&#39;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&#39;å¿½ç•¥æ–‡ä»¶&#39;</span> <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  additionalProperties<span class="token operator">:</span> <span class="token boolean">false</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">validate</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;MyPlugin&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options\n  <span class="token punctuation">}</span>\n  <span class="token function">apply</span> <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#39;MyPlugin&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>additionalAssets<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&#39;MyPlugin&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// æ‰‹åŠ¨æ·»åŠ æ–‡ä»¶</span>\n        compilation<span class="token punctuation">.</span><span class="token function">emitAsset</span><span class="token punctuation">(</span><span class="token string">&#39;a.txt&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n          <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&#39;hello&#39;</span> <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token comment">// ä½¿ç”¨ webpack-sources è½¬åŒ–æ–‡ä»¶</span>\n        <span class="token keyword">const</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;b.text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>\n        compilation<span class="token punctuation">.</span><span class="token function">emitAsset</span><span class="token punctuation">(</span><span class="token string">&#39;b.text&#39;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">RawSource</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n        <span class="token comment">// å¤åˆ¶æŒ‡å®šç›®å½•çš„æ–‡ä»¶</span>\n        <span class="token keyword">const</span> baseDir <span class="token operator">=</span> compiler<span class="token punctuation">.</span>options<span class="token punctuation">.</span>context\n        <span class="token keyword">const</span> toDir <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>to <span class="token operator">||</span> <span class="token string">&#39;.&#39;</span>\n        <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token punctuation">,</span> ignore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options\n        <span class="token keyword">const</span> fromDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">isAbsolute</span><span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">from</span> <span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>from<span class="token punctuation">)</span>\n        <span class="token keyword">const</span> paths <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">globby</span><span class="token punctuation">(</span>fromDir<span class="token punctuation">,</span> <span class="token punctuation">{</span> ignore <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// è·å–è¦å¤åˆ¶çš„æ–‡ä»¶çš„è·¯å¾„</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> filePath <span class="token keyword">of</span> paths<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">const</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>\n          <span class="token keyword">const</span> relativePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>\n          <span class="token keyword">const</span> filename <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span>\n          compilation<span class="token punctuation">.</span><span class="token function">emitAsset</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">RawRouce</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyPlugin\n</code></pre></div><p>æµ‹è¯• MyPlugin</p><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">,</span>\n  to<span class="token operator">:</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">,</span>\n  ignore<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;**/index.html&#39;</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n</code></pre></div><h3 id="html-webpack-plugin"><a class="header-anchor" href="#html-webpack-plugin" aria-hidden="true">#</a> html-webpack-plugin</h3><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">/* æŒ‡å®š html æ¨¡ç‰ˆï¼Œä¸æŒ‡å®šä¼šè‡ªåŠ¨ç”Ÿæˆ index.html */</span>\n  template<span class="token operator">:</span> <span class="token string">&#39;public/index.html&#39;</span><span class="token punctuation">,</span>\n\n  <span class="token comment">/* å‹ç¼© */</span>\n  minify<span class="token operator">:</span> <span class="token punctuation">{</span>\n    collapseWhiteSpace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    removeComments<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="inline-chunk-html-plugin"><a class="header-anchor" href="#inline-chunk-html-plugin" aria-hidden="true">#</a> inline-chunk-html-plugin</h3><p>å°† js å†…è”åˆ° index.html ä¸­</p><div class="language-js"><pre><code>isEnvProduction <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">InlineChunkHtmlPlugin</span><span class="token punctuation">(</span>HtmlWebpackPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">runtime.+\\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="mini-css-extract-plugin"><a class="header-anchor" href="#mini-css-extract-plugin" aria-hidden="true">#</a> mini-css-extract-plugin</h3><p>é…åˆå…¶å†…ç½®çš„ loader ï¼Œå¯ä»¥æå– css ä¸ºå¤–ç½®è¿æ¥å¼•å…¥</p><div class="language-js"><pre><code><span class="token comment">// è®¾ç½® css loader</span>\n<span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  use<span class="token operator">:</span> <span class="token punctuation">[</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// æ·»åŠ  plugin</span>\n<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  filename<span class="token operator">:</span> <span class="token string">&#39;css/app.css&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="intervolga-optimize-cssnano-plugin"><a class="header-anchor" href="#intervolga-optimize-cssnano-plugin" aria-hidden="true">#</a> @intervolga/optimize-cssnano-plugin</h3><h3 id="optimize-css-assets-webpack-plugin"><a class="header-anchor" href="#optimize-css-assets-webpack-plugin" aria-hidden="true">#</a> optimize-css-assets-webpack-plugin</h3><p>ç”¨äºå‹ç¼© css æ–‡ä»¶</p><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><div class="tip custom-block"><p class="custom-block-title">ğŸ’¡</p><p>è¡Œæ–‡ä¸­çš„ <code>resolve</code> å‡½æ•°æ˜¯ <code>path.resolve</code></p></div><h3 id="workbox-webpack-plugin"><a class="header-anchor" href="#workbox-webpack-plugin" aria-hidden="true">#</a> workbox-webpack-plugin</h3><p>ä½¿ç”¨ serviceWorker æ„å»º PWA æ¸è¿›å¼ç½‘ç»œå¼€å‘åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨è¯¥æ’ä»¶ç”Ÿæˆ <code>service-worker.js</code> é…ç½®æ–‡ä»¶</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token comment">/**\n       * å¸®åŠ© serviceWorker å¿«é€Ÿå¯åŠ¨\n       * åˆ é™¤æ—§çš„ serviceWorker\n       */</span>\n      clientsClaim<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      skipWaiting<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>åœ¨ main.js æ³¨å†Œ serviceWorker</p><div class="language-js"><pre><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;/service-worker&#39;</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="webpack-dllplugin"><a class="header-anchor" href="#webpack-dllplugin" aria-hidden="true">#</a> webpack.DllPlugin</h3><p>å¯¹æŸäº›ï¼ˆç¬¬ä¸‰æ–¹ï¼‰åº“<em>é¢„å…ˆ</em>è¿›è¡Œå•ç‹¬æ‰“åŒ…å¥½ï¼Œå¼€å‘è¿‡ç¨‹ä¸­ä¹‹é—´å¼•å…¥æ‰“åŒ…ç»“æœï¼Œè·³è¿‡è¯¥éƒ¨åˆ†æ–‡ä»¶çš„æ‰“åŒ…ï¼Œä»¥æé«˜æ„å»ºé€Ÿåº¦</p><div class="language-js"><pre><code><span class="token comment">// webpack.dll.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> webapck <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token operator">:</span> <span class="token punctuation">{</span>\n    dll<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;vue&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;vue-router&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jQuery&#39;</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token operator">:</span> <span class="token punctuation">{</span>\n    filename<span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>\n    path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;vendor&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    library<span class="token operator">:</span> <span class="token string">&#39;[name]_[hash]&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">/* ç”Ÿæˆ manifest.json æä¾›ç”Ÿæˆ dll çš„æ˜ å°„å…³ç³» */</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token comment">/* åŒ output.library é…ç½® */</span>\n      name<span class="token operator">:</span> <span class="token string">&#39;[name]_[hash]&#39;</span><span class="token punctuation">,</span>\n      path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;vendor/manifest.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  mode<span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>æ‰§è¡Œ <code>npx webpack --config webpack.dll.js</code> æ‰“åŒ…ç”Ÿæˆ <code>dll.js</code> å’Œ <code>manifest.json</code></p><p>ä¿®æ”¹ <code>webpack.config.js</code> é…ç½®ï¼Œåº”ç”¨æ‰“åŒ…ç»“æœ</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">/* webpack æ ¹æ® manifest å¿½ç•¥å·²æ‰“åŒ…åˆ° dll.js ä¸­çš„æ–‡ä»¶ */</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      manifest<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;vendor/manifest.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment">/* å°†é¢„å…ˆæ‰“åŒ…å¥½çš„ dll.js æ’å…¥åˆ° inex.html ä¸­  */</span>\n    <span class="token keyword">new</span> <span class="token class-name">require</span><span class="token punctuation">(</span><span class="token string">&#39;add-assets-html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      filepath<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;vendor/dll.js&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="webpack-defineplugin"><a class="header-anchor" href="#webpack-defineplugin" aria-hidden="true">#</a> webpack.DefinePlugin</h3><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token constant">PUBLIC_URL</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n</code></pre></div><h3 id="webpack-hotmodulereplacementplugin"><a class="header-anchor" href="#webpack-hotmodulereplacementplugin" aria-hidden="true">#</a> webpack.HotModuleReplacementPlugin</h3><div class="language-js"><pre><code>isEnvProduction <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="webpack-ignoreplugin"><a class="header-anchor" href="#webpack-ignoreplugin" aria-hidden="true">#</a> webpack.IgnorePlugin</h3><div class="language-js"><pre><code><span class="token comment">// https://github.com/jmblog/how-to-optimize-momentjs-with-webpack</span>\n<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\\.\\/locale$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moment$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>\n<span class="token comment">// or</span>\n<span class="token keyword">new</span> <span class="token class-name">wepback<span class="token punctuation">.</span>ContextReplacementPlugin</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moment[/\\\\]locale$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">zh-ch</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="manifest-plugin"><a class="header-anchor" href="#manifest-plugin" aria-hidden="true">#</a> manifest-plugin</h3><h2 id="hash"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> Hash</h2><table><thead><tr><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>hash</td><td>æ¯æ¬¡æ„å»ºéƒ½ä¼šå˜åŒ–ï¼ˆé™¤éä½ ä¸æƒ³ç¼“å­˜é™æ€èµ„æºï¼‰</td></tr><tr><td>chunkhash</td><td>æ ¹æ® chunk ç”Ÿæˆï¼Œå½“ main.js å¼•å…¥ css æ—¶ï¼Œcss å†…å®¹å˜åŒ–ï¼Œä¹Ÿä¼šå¯¼è‡´ç”Ÿæˆçš„ js æ–‡ä»¶ hash å˜åŒ–ï¼Œä¸” hash ä¸€æ ·</td></tr><tr><td>contenthash</td><td>æ ¹æ®æ–‡ä»¶å†…å®¹ç”Ÿäº§ hashï¼ˆå¯é ï¼‰</td></tr></tbody></table><h2 id="tree-shaking"><a class="header-anchor" href="#tree-shaking" aria-hidden="true">#</a> Tree Shaking</h2><p>å‰æï¼š1. ä½¿ç”¨ ES module 2. mode è®¾ç½®ä¸º production</p><p><code>import &quot;./style/index.less&quot;</code> è¢« shaking æ‰äº†ï¼Ÿï¼è¦æ­£ç¡®é…ç½®é¡¹ç›® <code>package.json</code> ä¸­çš„ <code>sideEffects</code> å­—æ®µï¼Œ</p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.less&quot;</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="code-split"><a class="header-anchor" href="#code-split" aria-hidden="true">#</a> Code Split</h2><p>ä½¿ç”¨ <code>import()</code> è¯­æ³•ï¼Œwebpack ä¼šè‡ªåŠ¨å°†æ¨¡å—å•ç‹¬æ‰“åŒ…ï¼Œå¯ä»¥å®ç°è¿è¡Œæ—¶åŠ è½½(lazy load) å’Œ æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½(prefetch)</p><div class="language-js"><pre><code><span class="token comment">/* å¦‚æœä¸æŒ‡å®š `webpackChunkName` æ–‡ä»¶åæ˜¯æ•°å­—é€’å¢ï¼Œä¸å‹å¥½ */</span>\n<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;math&quot;, webpackPrefetch: true */</span><span class="token punctuation">,</span> <span class="token string">&#39;./math&#39;</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p>é¢„åŠ è½½éœ€è¦æµè§ˆå™¨æ”¯æŒï¼Œæ³¨æ„å…¼å®¹æ€§é—®é¢˜</p></div><h2 id="optimize"><a class="header-anchor" href="#optimize" aria-hidden="true">#</a> Optimize</h2><ul><li><p>æ‰“åŒ…é€Ÿåº¦</p><ol><li>loader ä½¿ç”¨ oneOf ï¼Œå‘½ä¸­ä¸€ä¸ª loader å°±ä¸èµ°å…¶ä»– loader äº† ä½¿ç”¨ <code>exclude</code> æ’é™¤ <code>node_modules</code> ä¹‹ç±»çš„ç›®å½•</li></ol><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  rules<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">/* æœ‰ä¸¤ç§ loader å¤„ç†äº† jsæ–‡ä»¶ï¼Œè¿™é‡Œè¦æåˆ° oneOf å¤–é¢ï¼Œå¦åˆ™æœ‰ä¸€ä¸ªä¸ç”Ÿæ•ˆ  */</span>\n    <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">&#39;eslint-loader&#39;</span><span class="token punctuation">,</span> enforce<span class="token operator">:</span> <span class="token string">&#39;pre&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n      oneOf<span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><ol start="2"><li>ä½¿ç”¨ <code>thread-loader</code> å¼€å¯å¤šè¿›ç¨‹æ‰“åŒ…</li><li>ä½¿ç”¨ <code>webpack.DllPlugin</code> é¢„å…ˆæ‰“åŒ…å¥½ä¸€äº›ç¬¬ä¸‰æ–¹åº“ï¼ˆè¿™äº›ä¾èµ–ä¸ä¼šè½»æ˜“æ›´æ–°ï¼‰ï¼Œå†æ‰“åŒ…æ—¶è·³è¿‡è¿™äº›åº“</li><li>é…ç½® <code>externals</code> æŸäº›æ–‡ä»¶èµ° CDNï¼Œç›´æ¥è·³è¿‡æ‰“åŒ…</li><li>é…ç½® <code>devServer.watchOptions.ignored</code> å¿½ç•¥æŸäº›ç›®å½•(node_modules)</li><li>é…ç½® <code>cache-loader</code> ç¼“å­˜ç¼–è¯‘ç»“æœ</li><li>contenthas æ˜¯å¦æ¯” has æ›´æ…¢ï¼Ÿ</li></ol></li></ul><h3 id="development"><a class="header-anchor" href="#development" aria-hidden="true">#</a> development</h3><ul><li><p>HMR</p><ol><li>devServer å¼€å¯ Hot Module Replace</li></ol></li><li><p>è°ƒè¯•ä½“éªŒ</p><ol><li>å…¼é¡¾ç¼–è¯‘é€Ÿåº¦å’Œè°ƒè¯•å‹å¥½ï¼Œdevtool é€‰æ‹© <code>eval-source-map</code>ï¼ˆè°ƒè¯•æ›´å¥½ï¼‰æˆ– <code>eval-cheap-module-source-map</code>ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰</li></ol></li><li><p>ç¼“å­˜</p><ol><li><code>babel-loader</code> options è®¾ç½® <code>cacheDirectory: true</code></li></ol></li></ul><h3 id="production"><a class="header-anchor" href="#production" aria-hidden="true">#</a> production</h3><ul><li><p>è¿è¡Œæ—¶æ€§èƒ½</p></li><li><p>éšè—æºç </p><ol><li>devtool è®¾ç½®ä¸º <code>nosources-source-map</code> æˆ– false ã€‚åˆ‡å¿Œä½¿ç”¨ inline- ï¼Œè¿™ä¼šä½¿ä»£ç ä½“ç§¯å˜å¾—å¾ˆå¤§ï¼</li><li>æ··æ·†</li></ol></li><li><p>åŠ è½½é€Ÿåº¦</p><ol><li>ä½¿ç”¨ ES module ä»¥å®ç° tree shaking</li><li>é™æ€èµ„æºé¢„å…ˆ gzipï¼ˆæœåŠ¡å™¨éœ€å¼€å¯å¯¹åº”é…ç½®ï¼‰</li><li>é…ç½® <code>optimization: { splitChunks }</code> æŠ½ç¦»å…¬å…±ä¾èµ–ä¸ºå•ç‹¬ chunk é™ä½ä»£ç å˜åŠ¨ç¼“å­˜å¤±æ•ˆ</li><li>ä½¿ç”¨ <code>import()</code> å®ç°æ‡’åŠ è½½ã€é¢„åŠ è½½</li><li>é…ç½® externals ï¼Œé…ç½® CDN</li></ol></li><li><p>ç¼“å­˜</p><ol><li>é¿å…ç¼“å­˜å¤±æ•ˆï¼šæ–‡ä»¶åä¸ä½¿ç”¨ <code>hash</code> <code>chunkhash</code>ï¼Œå¯ç”¨ <code>runtimeChunk</code></li><li>é¿å…ç¼“å­˜ä¸å¤±æ•ˆï¼šé™æ€èµ„æºè¾“å‡ºæ–‡ä»¶åä½¿ç”¨ <code>contenthash</code> åç¼€ï¼Œæ–‡ä»¶æ”¹åŠ¨éƒ¨ç½²åï¼Œæµè§ˆå™¨è¯·æ±‚æœ€æ–°æ„å»ºç»“æœ</li></ol></li></ul>',138);t.render=function(a,p,t,o,c,l){return n(),s("div",null,[e])};export default t;export{p as __pageData};
