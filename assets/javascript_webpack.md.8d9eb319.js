import{o as n,c as s,e as a}from"./app.9ecb75df.js";const e='{"title":"webpack","description":"","frontmatter":{"title":"webpack"},"headers":[{"level":3,"title":"Getting Started","slug":"getting-started"},{"level":2,"title":"Config","slug":"config"},{"level":3,"title":"mode","slug":"mode"},{"level":3,"title":"entry","slug":"entry"},{"level":3,"title":"output","slug":"output"},{"level":3,"title":"loader","slug":"loader"},{"level":3,"title":"plugins","slug":"plugins"},{"level":3,"title":"optimization","slug":"optimization"},{"level":3,"title":"devServer","slug":"devserver"},{"level":3,"title":"devtool","slug":"devtool"},{"level":2,"title":"Official Loader","slug":"official-loader"},{"level":3,"title":"style-loader","slug":"style-loader"},{"level":3,"title":"css-loader","slug":"css-loader"},{"level":3,"title":"postcss-loader","slug":"postcss-loader"},{"level":3,"title":"less-loader","slug":"less-loader"},{"level":3,"title":"url-loader","slug":"url-loader"},{"level":3,"title":"file-loader","slug":"file-loader"},{"level":3,"title":"eslint-loader","slug":"eslint-loader"},{"level":3,"title":"babel-loader","slug":"babel-loader"},{"level":2,"title":"Official Plugin","slug":"official-plugin"},{"level":3,"title":"html-webpack-plugin","slug":"html-webpack-plugin"},{"level":3,"title":"mini-css-extract-plugin","slug":"mini-css-extract-plugin"},{"level":3,"title":"optimize-css-assets-webpack-plugin","slug":"optimize-css-assets-webpack-plugin"},{"level":3,"title":"workbox-webpack-plugin","slug":"workbox-webpack-plugin"},{"level":2,"title":"Hash","slug":"hash"},{"level":2,"title":"Tree Shaking","slug":"tree-shaking"},{"level":2,"title":"Code Split","slug":"code-split"},{"level":2,"title":"Optimize","slug":"optimize"},{"level":3,"title":"development","slug":"development"},{"level":3,"title":"production","slug":"production"}],"relativePath":"javascript/webpack.md","lastUpdated":1614345189849}',t={},p=a('<h3 id="getting-started"><a class="header-anchor" href="#getting-started" aria-hidden="true">#</a> Getting Started</h3><p>æ— éœ€é…ç½®ï¼Œ<code>webpack</code> èƒ½ç›´æ¥å¤„ç† js/jsonï¼Œæ”¯æŒ ES module</p><div class="language-bash"><pre><code>webpack src/entry.js -o dits/bundle.js --mode<span class="token operator">=</span>development\n</code></pre></div><p><code>webpack</code> é»˜è®¤è¯»å–å·¥ä½œç›®å½•ä¸‹çš„ <code>webpack.config.js</code> æ–‡ä»¶</p><h2 id="config"><a class="header-anchor" href="#config" aria-hidden="true">#</a> Config</h2><h3 id="mode"><a class="header-anchor" href="#mode" aria-hidden="true">#</a> mode</h3><p>production æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨å‹ç¼© js ä»£ç </p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">// mode: &#39;production&#39;,</span>\n  mode<span class="token operator">:</span> <span class="token string">&#39;develoment&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="entry"><a class="header-anchor" href="#entry" aria-hidden="true">#</a> entry</h3><p>å•æ–‡ä»¶å…¥å£</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  entry<span class="token operator">:</span> <span class="token string">&#39;src/main.js&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>å¤šæ–‡ä»¶å…¥å£ï¼Œå¯ç”¨äºå¤šé¡µé¢æ‰“åŒ…</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  entry<span class="token operator">:</span> <span class="token punctuation">{</span>\n    page1<span class="token operator">:</span> <span class="token string">&#39;src/page1/index.js&#39;</span><span class="token punctuation">,</span>\n    page2<span class="token operator">:</span> <span class="token string">&#39;src/page2/index.js&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="output"><a class="header-anchor" href="#output" aria-hidden="true">#</a> output</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  output<span class="token operator">:</span> <span class="token punctuation">{</span>\n    filename<span class="token operator">:</span> <span class="token string">&#39;js/[name].[contenthash:10].js&#39;</span><span class="token punctuation">,</span>\n    path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="loader"><a class="header-anchor" href="#loader" aria-hidden="true">#</a> loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  module<span class="token operator">:</span> <span class="token punctuation">{</span>\n    rules<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// é…ç½®å½¢å¼ä¸€</span>\n      <span class="token punctuation">{</span>\n        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n        use<span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token string">&#39;less-loader&#39;</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span>\n            loader<span class="token operator">:</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">,</span>\n            options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token comment">// é…ç½®å½¢å¼äºŒ</span>\n      <span class="token punctuation">{</span>\n        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(jpe?g|png|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n        loader<span class="token operator">:</span> <span class="token string">&#39;url-loader&#39;</span><span class="token punctuation">,</span>\n        options<span class="token operator">:</span> <span class="token punctuation">{</span>\n          limit<span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>\n          outputPath<span class="token operator">:</span> <span class="token string">&#39;imgs&#39;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p>å†™åœ¨åé¢çš„ loader å…ˆæ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œç»“æœäº¤ç”±å‰ä¸€ä¸ª loader å¤„ç†</p></div><h3 id="plugins"><a class="header-anchor" href="#plugins" aria-hidden="true">#</a> plugins</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="optimization"><a class="header-anchor" href="#optimization" aria-hidden="true">#</a> optimization</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">/**\n       * å°† node_modules çš„ä»£ç æ‰“åŒ…æˆä¸€ä¸ªå•ç‹¬çš„ chunk\n       * ä¼šè‡ªåŠ¨åˆ†æå¤šå…¥å£ï¼Œå¹¶æŠ½ç¦»å…¬å…±çš„ä¾èµ–\n       */</span>\n      chunks<span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="devserver"><a class="header-anchor" href="#devserver" aria-hidden="true">#</a> devServer</h3><p>æ‰§è¡Œ <code>npx webpack-dev-server</code>ï¼Œç¼–è¯‘æ‰“åŒ…ç»“æœä¿å­˜åœ¨å†…å­˜ï¼Œä¸è¾“å‡ºæ–‡ä»¶ï¼Œwatch æ–‡ä»¶å˜åŒ–åè‡ªåŠ¨ç¼–è¯‘</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">/* æ‰“åŒ…è¾“å‡ºç›®å½• */</span>\n  conentBase<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n  <span class="token comment">/* å¯ç”¨ gizp */</span>\n  compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>\n\n  <span class="token comment">/* åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ */</span>\n  open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n\n  <span class="token comment">/* HMR */</span>\n  hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><h3 id="devtool"><a class="header-anchor" href="#devtool" aria-hidden="true">#</a> devtool</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  devtool<span class="token operator">:</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre></div><table><thead><tr><th>å–å€¼</th><th>æ•ˆæœ</th><th>source map æ–‡ä»¶</th></tr></thead><tbody><tr><td>source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œèƒ½è·³è½¬åˆ°æºä»£ç å‡ºé”™ä½ç½®</td><td>å®Œæ•´åˆ° sourceMap æ–‡ä»¶</td></tr><tr><td>inline-source-map</td><td>åŒä¸Š</td><td>æŠŠæ‰€æœ‰ sourceMap å†…è”åˆ° js å°¾éƒ¨ï¼Œä¼˜åŠ¿ï¼šæ„å»ºé€Ÿåº¦å¿«</td></tr><tr><td>eval-source-map</td><td>æ–‡ä»¶åé”™è¯¯ï¼Œå…¶ä»–åŒä¸Š</td><td>æ¯ä¸ª sourceMap åˆ†åˆ«å†…è”åˆ°æ¯ä¸ª eval å‡½æ•°ä¸­</td></tr><tr><td>hidden-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åï¼Œä½†è¡Œæ•°é”™è¯¯ï¼Œä¼šè·³è½¬åˆ°æ„å»ºåç å‡ºé”™ä½ç½®</td><td></td></tr><tr><td>nosource-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œæ— æ³•è·³è½¬åˆ°ä»£ç å‡ºé”™ä½ç½®</td><td>æ—  sourceMap æ–‡ä»¶</td></tr><tr><td>cheap-source-map</td><td>æ‰“å°é”™è¯¯æ–‡ä»¶åå’Œè¡Œæ•°ï¼Œèƒ½è·³è½¬åˆ°æºä»£ç ä½ç½®ï¼Œä¸èƒ½ç²¾ç¡®å®šä½åˆ°é”™è¯¯æ‰€åœ¨åˆ—</td><td></td></tr><tr><td>cheap-module-source-map</td><td>åŒä¸Š</td><td>ä¼šå°† loader çš„ source map åŠ è¿›æ¥</td></tr></tbody></table><p>é€Ÿåº¦ eval &gt; inline &gt; cheap</p><p>é€Ÿåº¦ <code>eval-cheap-source-map</code> &gt; <code>eval-source-map</code></p><p>è°ƒè¯•å‹å¥½ <code>source-map</code> &gt; <code>cheap-module-source-map</code> &gt; <code>cheap-source-map</code></p><h2 id="official-loader"><a class="header-anchor" href="#official-loader" aria-hidden="true">#</a> Official Loader</h2><h3 id="style-loader"><a class="header-anchor" href="#style-loader" aria-hidden="true">#</a> style-loader</h3><h3 id="css-loader"><a class="header-anchor" href="#css-loader" aria-hidden="true">#</a> css-loader</h3><h3 id="postcss-loader"><a class="header-anchor" href="#postcss-loader" aria-hidden="true">#</a> postcss-loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    loader<span class="token operator">:</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">,</span>\n    options<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">/* å›ºå®šå†™æ³• */</span>\n      ident<span class="token operator">:</span> <span class="token string">&#39;postcss&#39;</span><span class="token punctuation">,</span>\n      <span class="token function">plugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">[</span>\n          <span class="token comment">/**\n           * è¯¥æ’ä»¶ç”¨äºè§£æ(package.json) browserslist çš„é…ç½®\n           * ä»¥æ„å»ºå…¼å®¹åˆ°æŒ‡å®šæµè§ˆå™¨çš„ css\n           */</span>\n          <span class="token function">required</span><span class="token punctuation">(</span><span class="token string">&#39;postcss-preset-env&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p><code>package.json</code> ä¸­çš„é…ç½®</p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;browserslist&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;development&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token string">&quot;last 1 chrome version&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;last 1 firefox version&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;last 1 safari version&quot;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;production&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token string">&quot;&gt;2%&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;not dead&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;not op_mini all&quot;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p><code>postcss-preset-env</code> ä¾èµ– <code>process.<wbr>env.NODE_ENV</code> è¯»å– <code>browserslist</code> å¯¹åº”çš„é…ç½®ï¼Œåº”ç¡®ä¿è¯¥å€¼æ­£ç¡®è®¾ç½®</p></div><h3 id="less-loader"><a class="header-anchor" href="#less-loader" aria-hidden="true">#</a> less-loader</h3><h3 id="url-loader"><a class="header-anchor" href="#url-loader" aria-hidden="true">#</a> url-loader</h3><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(jpe?g|png|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;url-loader&#39;</span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è½¬ base64 çš„ä¸Šé™ */</span>\n    limit<span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* ä½¿ç”¨ es module è§£æ */</span>\n    esModule<span class="token operator">:</span> <span class="token boolean">true</span>ï¼Œ\n\n    name<span class="token operator">:</span> <span class="token string">&#39;[contenthash:10].[ext]&#39;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="file-loader"><a class="header-anchor" href="#file-loader" aria-hidden="true">#</a> file-loader</h3><p>å’Œ <code>url-loader</code> ç±»ä¼¼ï¼Œä½†æ˜¯ä¸ä¼šè½¬ <code>base64</code></p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token comment">// test: /\\.(woff)$/, å¯ä»¥ä¸æŒ‡å®š</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(css|less|scss|js|json|jpe?g|png|gif|)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;file-loader&#39;</span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;[contenthash:10].[ext]&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="eslint-loader"><a class="header-anchor" href="#eslint-loader" aria-hidden="true">#</a> eslint-loader</h3><p>å®‰è£… <code>eslint</code> <code>eslint-plugin-import</code></p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;eslint-loader&#39;</span><span class="token punctuation">,</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// æé«˜æ€§èƒ½</span>\n  enforce<span class="token operator">:</span> <span class="token string">&#39;pre&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å¿…é¡»ä¼˜å…ˆæ‰§è¡Œï¼Œæ£€æŸ¥ä¸é€šè¿‡å°±ä¸èµ°åé¢çš„ loader</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* è‡ªåŠ¨ä¿®å¤é”™è¯¯ */</span>\n    fix<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><p>å®‰è£… <code>eslint-config-airbnb-base</code> å¹¶åœ¨ <code>package.json</code> ä¸­é…ç½®</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  <span class="token string">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb-base&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token string">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="tip custom-block"><p class="custom-block-title">ğŸ’¡</p><p>è®¾ç½® <code>env.browser</code>ï¼Œå¦åˆ™ eslint ä¼šåˆ¤å®š <code>window</code> <code>document</code> <code>navigator</code> æ˜¯æœªå£°æ˜å˜é‡</p></div><h3 id="babel-loader"><a class="header-anchor" href="#babel-loader" aria-hidden="true">#</a> babel-loader</h3><p>å®‰è£… <code>@babel/core</code> (æ ¸å¿ƒ) <code>@babel/preset-env</code>ï¼ˆè§„åˆ™é›†ï¼‰ <code>core-js</code>ï¼ˆå…¼å®¹ APIï¼‰</p><blockquote><p>As of Babel 7.4.0, <code>@babel/polyfill</code> has been deprecated in favor of directly including <code>core-js/stable</code> (to polyfill ECMAScript features) and `...</p></blockquote><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  loader<span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span>\n  exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  options<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">/* é¢„è®¾è§„åˆ™ */</span>\n    presets<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        <span class="token comment">/* åªå¼•å…¥ä½¿ç”¨åˆ°çš„ polyfill */</span>\n        useBuiltIns<span class="token operator">:</span> <span class="token string">&#39;useage&#39;</span><span class="token punctuation">,</span>\n\n        <span class="token comment">/* æŒ‡å®šå½“å‰å®‰è£…çš„ç‰ˆæœ¬ */</span>\n        corejs<span class="token operator">:</span> <span class="token punctuation">{</span> version<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n        targets<span class="token operator">:</span> <span class="token punctuation">{</span>\n          chrome<span class="token operator">:</span> <span class="token string">&#39;60&#39;</span><span class="token punctuation">,</span>\n          firefox<span class="token operator">:</span> <span class="token string">&#39;60&#39;</span><span class="token punctuation">,</span>\n          safari<span class="token operator">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span>\n          ie<span class="token operator">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span>\n          edge<span class="token operator">:</span> <span class="token string">&#39;17&#39;</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">]</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">/* äºŒæ¬¡æ„å»ºæ—¶ï¼Œè¯»å–ä¹‹å‰ çš„ç¼“å­˜ */</span>\n    cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>å¸¸ç”¨çš„è¡Œå†…è§„åˆ™</p><div class="language-js"><pre><code><span class="token comment">// eslint-disable-next-line</span>\n\n<span class="token comment">/* global jQuery */</span>\n</code></pre></div><h2 id="official-plugin"><a class="header-anchor" href="#official-plugin" aria-hidden="true">#</a> Official Plugin</h2><h3 id="html-webpack-plugin"><a class="header-anchor" href="#html-webpack-plugin" aria-hidden="true">#</a> html-webpack-plugin</h3><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">/* æŒ‡å®š html æ¨¡ç‰ˆï¼Œä¸æŒ‡å®šä¼šè‡ªåŠ¨ç”Ÿæˆ index.html */</span>\n  template<span class="token operator">:</span> <span class="token string">&#39;public/index.html&#39;</span><span class="token punctuation">,</span>\n\n  <span class="token comment">/* å‹ç¼© */</span>\n  minify<span class="token operator">:</span> <span class="token punctuation">{</span>\n    collapseWhiteSpace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    removeComments<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="mini-css-extract-plugin"><a class="header-anchor" href="#mini-css-extract-plugin" aria-hidden="true">#</a> mini-css-extract-plugin</h3><p>é…åˆå…¶å†…ç½®çš„ loader ï¼Œå¯ä»¥æå– css ä¸ºå¤–ç½®è¿æ¥å¼•å…¥</p><div class="language-js"><pre><code><span class="token comment">// è®¾ç½® css loader</span>\n<span class="token punctuation">{</span>\n  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>\n  use<span class="token operator">:</span> <span class="token punctuation">[</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// æ·»åŠ  plugin</span>\n<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  filename<span class="token operator">:</span> <span class="token string">&#39;css/app.css&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h3 id="optimize-css-assets-webpack-plugin"><a class="header-anchor" href="#optimize-css-assets-webpack-plugin" aria-hidden="true">#</a> optimize-css-assets-webpack-plugin</h3><p>ç”¨äºå‹ç¼© css æ–‡ä»¶</p><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><div class="tip custom-block"><p class="custom-block-title">ğŸ’¡</p><p>è¡Œæ–‡ä¸­çš„ <code>resolve</code> å‡½æ•°æ˜¯ <code>path.resolve</code></p></div><h3 id="workbox-webpack-plugin"><a class="header-anchor" href="#workbox-webpack-plugin" aria-hidden="true">#</a> workbox-webpack-plugin</h3><p>ä½¿ç”¨ serviceworker æ„å»º PWA æ¸è¿›å¼ç½‘ç»œå¼€å‘åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨è¯¥æ’ä»¶ç”Ÿæˆ serviceworker é…ç½®æ–‡ä»¶</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token comment">/**\n       * å¸®åŠ© serviceworker å¿«é€Ÿå¯åŠ¨\n       * åˆ é™¤æ—§çš„ serviceworker\n       */</span>\n      clientsClaim<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      skipWaiting<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>åœ¨ main.js æ³¨å†Œ serviceworker</p><div class="language-js"><pre><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceworker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    navigator<span class="token punctuation">.</span>serviceworker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;/service-worker&#39;</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><h2 id="hash"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> Hash</h2><table><thead><tr><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>hash</td><td>æ¯æ¬¡æ„å»ºéƒ½ä¼šå˜åŒ–ï¼ˆé™¤éä½ ä¸æƒ³ç¼“å­˜é™æ€èµ„æºï¼‰</td></tr><tr><td>chunkhash</td><td>æ ¹æ® chunk ç”Ÿæˆï¼Œå½“ main.js å¼•å…¥ css æ—¶ï¼Œcss å†…å®¹å˜åŒ–ï¼Œä¹Ÿä¼šå¯¼è‡´ç”Ÿæˆçš„ js æ–‡ä»¶ hash å˜åŒ–</td></tr><tr><td>contenthash</td><td>æ ¹æ®æ–‡ä»¶å†…å®¹ç”Ÿäº§ hashï¼ˆå¯é ï¼‰</td></tr></tbody></table><h2 id="tree-shaking"><a class="header-anchor" href="#tree-shaking" aria-hidden="true">#</a> Tree Shaking</h2><p>å‰æï¼š1. ä½¿ç”¨ ES module 2. mode è®¾ç½®ä¸º production</p><p><code>import &quot;./style/index.less&quot;</code> è¢« shaking æ‰äº†ï¼Ÿï¼è¦æ­£ç¡®é…ç½®é¡¹ç›® <code>package.json</code> ä¸­çš„ <code>sideEffects</code> å­—æ®µï¼Œ</p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.less&quot;</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="code-split"><a class="header-anchor" href="#code-split" aria-hidden="true">#</a> Code Split</h2><p>ä½¿ç”¨ <code>import()</code> è¯­æ³•ï¼Œwebpack ä¼šè‡ªåŠ¨å°†æ¨¡å—å•ç‹¬æ‰“åŒ…ï¼Œå¯ä»¥å®ç°è¿è¡Œæ—¶åŠ è½½(lazy load) å’Œ æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½(prefetch)</p><div class="language-js"><pre><code><span class="token comment">/* å¦‚æœä¸æŒ‡å®š `webpackChunkName` æ–‡ä»¶åæ˜¯æ•°å­—é€’å¢ï¼Œä¸å‹å¥½ */</span>\n<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: math, webpackPrefetch: true */</span><span class="token punctuation">,</span> <span class="token string">&#39;./math&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n</code></pre></div><div class="warning custom-block"><p class="custom-block-title">âš ï¸</p><p>é¢„åŠ è½½éœ€è¦æµè§ˆå™¨æ”¯æŒï¼Œæ³¨æ„å…¼å®¹æ€§é—®é¢˜</p></div><h2 id="optimize"><a class="header-anchor" href="#optimize" aria-hidden="true">#</a> Optimize</h2><p><code>style-loader</code> <code>vue-loader</code> å†…éƒ¨å®ç°äº† <code>HMR</code>ï¼Œä½† js é»˜è®¤æ²¡æœ‰å®ç°ï¼Œä¿®æ”¹ js æ–‡ä»¶ä¼šå¯¼è‡´æ‰€ä»¥æ¨¡å—é‡æ–°ç¼–è¯‘</p><p>ç¤ºä¾‹ï¼šå½“ <code>math.js</code> å†…å®¹å˜åŒ–æ—¶ï¼Œå®ç° <code>math.js</code> çƒ­æ›´æ–°</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math&#39;</span>\n\n<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n\n<span class="token comment">// åˆ¤æ–­æ˜¯å¦å¼€å¯äº† HMR</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#39;./math.js&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><p>loader ä½¿ç”¨ oneOf ï¼Œå‘½ä¸­ä¸€ä¸ª loader å°±ä¸èµ°å…¶ä»– loader äº†</p><div class="language-js"><pre><code><span class="token punctuation">{</span>\n  rules<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">/* æœ‰ä¸¤ç§ loader å¤„ç†äº† jsæ–‡ä»¶ï¼Œè¿™é‡Œè¦æåˆ° oneOf å¤–é¢ï¼Œå¦åˆ™æœ‰ä¸€ä¸ªä¸ç”Ÿæ•ˆ  */</span>\n    <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">&#39;eslint-loader&#39;</span><span class="token punctuation">,</span> enforce<span class="token operator">:</span> <span class="token string">&#39;pre&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n      oneOf<span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n\n</code></pre></div><h3 id="development"><a class="header-anchor" href="#development" aria-hidden="true">#</a> development</h3><ul><li>æ‰“åŒ…é€Ÿåº¦</li></ul><p>devServer å¼€å¯ Hot Module Replace</p><ul><li>è°ƒè¯•ä½“éªŒ</li></ul><p>å…¼é¡¾ç¼–è¯‘é€Ÿåº¦å’Œè°ƒè¯•å‹å¥½ï¼Œdevtool é€‰æ‹© <code>eval-source-map</code>ï¼ˆè°ƒè¯•æ›´å¥½ï¼‰æˆ– <code>eval-cheap-module-source-map</code>ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰</p><ul><li>ç¼“å­˜</li></ul><ol><li><code>babel-loader</code> options è®¾ç½® <code>cacheDirectory: true</code></li></ol><h3 id="production"><a class="header-anchor" href="#production" aria-hidden="true">#</a> production</h3><ul><li><p>æ‰“åŒ…é€Ÿåº¦</p></li><li><p>è¿è¡Œæ—¶æ€§èƒ½</p></li><li><p>éšè—æºç </p></li></ul><p>devtool è®¾ç½®ä¸º <code>nosource-source-map</code> ã€‚åˆ‡å¿Œä½¿ç”¨ inline- ï¼Œè¿™ä¼šä½¿ä»£ç ä½“ç§¯å˜å¾—å¾ˆå¤§ï¼</p><ul><li>åŠ è½½é€Ÿåº¦</li></ul><ol><li>ä½¿ç”¨ ES module ä»¥å®ç° tree shaking</li><li>é™æ€èµ„æºè¾“å‡ºæ–‡ä»¶åä½¿ç”¨ <code>contenthash</code> åç¼€ï¼Œè§£å†³ç¼“å­˜ä¸å¤±æ•ˆé—®é¢˜</li><li>é™æ€èµ„æºé¢„å…ˆ gzipï¼ˆæœåŠ¡å™¨éœ€å¼€å¯å¯¹åº”é…ç½®ï¼‰</li><li>é…ç½® <code>optimization: { splitChunks }</code>æŠ½ç¦»å…¬å…±ä¾èµ–ä¸ºå•ç‹¬ chunk</li><li>ä½¿ç”¨ <code>import()</code> å®ç°æ‡’åŠ è½½ã€é¢„åŠ è½½</li></ol>',100);t.render=function(a,e,t,o,c,l){return n(),s("div",null,[p])};export default t;export{e as __pageData};
